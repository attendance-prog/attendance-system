<!DOCTYPE html>
<html>
<body>
<h2>ðŸŒ± GO GREEN â€“ Admin Dashboard</h2>

<button onclick="markAttendance()">Mark My Attendance</button>
<button onclick="loadMyAttendance()">View My Attendance</button>

<h3>My Attendance</h3>
<pre id="att"></pre>

<h3>Add Location</h3>
<input id="room" placeholder="Room">
<input id="lat" placeholder="Latitude">
<input id="lng" placeholder="Longitude">
<input id="rad" placeholder="Radius">
<button onclick="addLocation()">Add</button>

<h3>Add Subject</h3>
<input id="sid" placeholder="Subject ID">
<input id="sname" placeholder="Subject Name">
<input id="dept" placeholder="Department">
<input id="sem" placeholder="Semester">
<button onclick="addSubject()">Add</button>

<script>
const API = "https://script.google.com/macros/s/AKfycbwV_SjR5wASHwKWjWd-fLlVFFWbc-pGAUUVXcYlEOUbH1JeUnwILr-nMhPvHWLoUW19BQ/exec";
const email = localStorage.getItem("email");
const role = "ADMIN";

function post(data){
  fetch(API,{
    method:"POST",
    body:JSON.stringify(data)
  }).then(r=>r.json()).then(console.log);
}

function markAttendance(){
  navigator.geolocation.getCurrentPosition(pos=>{
    post({
      action:"markStaffAttendance",
      email,
      role,
      latitude:pos.coords.latitude,
      longitude:pos.coords.longitude,
      room:"ADMIN"
    });
    alert("Attendance marked");
  });
}

function loadMyAttendance(){
  post({
    action:"getMyAttendance",
    email
  });
}

function addLocation(){
  post({
    action:"addLocation",
    room:room.value,
    lat:lat.value,
    lng:lng.value,
    radius:rad.value
  });
}

function addSubject(){
  post({
    action:"addSubject",
    subjectId:sid.value,
    subjectName:sname.value,
    department:dept.value,
    semester:sem.value
  });
}
</script>
</body>
</html>
